<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ó–∞–∫–∞–∑ —Ç–∞–∫—Å–∏ - –¢–∞–∫—Å–∏ –ø–æ –Æ–∂–Ω–æ–º—É</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    {% if not yandex_maps_api_key %}
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="">
    {% endif %}
    {% if yandex_maps_api_key %}
    <script src="https://api-maps.yandex.ru/2.1/?apikey={{ yandex_maps_api_key }}&lang=ru_RU" type="text/javascript"></script>
    {% endif %}
</head>
<body class="page-passenger">
    <div class="container container--passenger">
        <div class="passenger-panel passenger-panel--order">
            <header class="panel-header panel-header--compact">
                <h1>üöï –ó–∞–∫–∞–∑ —Ç–∞–∫—Å–∏</h1>
                <p class="role-switch"><a href="/">–ì–ª–∞–≤–Ω–∞—è</a> ¬∑ <a href="#" id="switch-to-driver">üöï –†–∞–±–æ—Ç–∞ –≤–æ–¥–∏—Ç–µ–ª–µ–º</a></p>
                <div class="drivers-count" id="drivers-count-wrap" style="display:none;">–í–æ–¥–∏—Ç–µ–ª–µ–π –æ–Ω–ª–∞–π–Ω: <strong id="drivers-online-count">0</strong></div>
            </header>
            
            <div id="order-form-section">
                <p id="map-hint" class="map-hint">–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç—ã‚Ä¶</p>
                <div class="map-toolbar">
                    <button type="button" class="btn btn-outline btn-sm" id="my-location-btn">üìç –ú–æ—ë –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ</button>
                </div>
                <div id="map" class="order-map"></div>
                
                <form id="order-form" class="order-form-fields">
                    <div class="form-group form-group-compact">
                        <label for="pickup-address">–û—Ç–∫—É–¥–∞</label>
                        <div class="input-with-reset">
                            <input type="text" id="pickup-address" placeholder="–¢–æ—á–∫–∞ –Ω–∞ –∫–∞—Ä—Ç–µ" readonly>
                            <button type="button" class="btn-reset" id="reset-pickup-btn" title="–°–±—Ä–æ—Å–∏—Ç—å —Ç–æ—á–∫—É">‚Ü∫</button>
                        </div>
                        <span class="coords" id="pickup-coords"></span>
                    </div>
                    <div class="form-group form-group-compact">
                        <label for="destination-address">–ö—É–¥–∞</label>
                        <div class="input-with-reset">
                            <input type="text" id="destination-address" placeholder="–¢–æ—á–∫–∞ –Ω–∞ –∫–∞—Ä—Ç–µ" readonly>
                            <button type="button" class="btn-reset" id="reset-dest-btn" title="–°–±—Ä–æ—Å–∏—Ç—å —Ç–æ—á–∫—É">‚Ü∫</button>
                        </div>
                        <span class="coords" id="destination-coords"></span>
                    </div>
                    <button type="submit" class="btn btn-primary btn-block" id="confirm-order-btn" disabled>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
                </form>
            </div>
            
            <div id="order-status-section" class="order-status-section" style="display: none;">
                <h2>–°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞</h2>
                <div class="order-status-card">
                    <div class="status-steps">
                        <div class="step" id="step-pending"><div class="step-icon">‚è≥</div><div class="step-label">–û–∂–∏–¥–∞–Ω–∏–µ –≤–æ–¥–∏—Ç–µ–ª—è</div></div>
                        <div class="step" id="step-assigned"><div class="step-icon">üöó</div><div class="step-label">–í–æ–¥–∏—Ç–µ–ª—å –Ω–∞–∑–Ω–∞—á–µ–Ω</div></div>
                        <div class="step" id="step-accepted"><div class="step-icon">‚úÖ</div><div class="step-label">–í–æ–¥–∏—Ç–µ–ª—å –ø—Ä–∏–Ω—è–ª</div></div>
                        <div class="step" id="step-completed"><div class="step-icon">üèÅ</div><div class="step-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</div></div>
                    </div>
                    <div class="order-details">
                        <p><strong>–û—Ç–∫—É–¥–∞:</strong> <span id="status-pickup"></span></p>
                        <p><strong>–ö—É–¥–∞:</strong> <span id="status-destination"></span></p>
                        <p><strong>–°—Ç–∞—Ç—É—Å:</strong> <span id="status-text"></span></p>
                    </div>
                    <button id="cancel-order-btn" class="btn btn-danger" style="display: none;">–û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑</button>
                </div>
            </div>
        </div>
    </div>
    
    {% if not yandex_maps_api_key %}
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    {% endif %}
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script>window.USE_YANDEX = {{ 'true' if yandex_maps_api_key else 'false' }};</script>
    <script src="{{ url_for('static', filename='js/passenger.js') }}?v=5"></script>
</body>
</html>
