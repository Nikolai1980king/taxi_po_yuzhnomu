# üöï –¢–∞–∫—Å–∏-–±–æ—Ç (–≤–æ–¥–∏—Ç–µ–ª–∏ –∏ –ø–∞—Å—Å–∞–∂–∏—Ä—ã)

Telegram-–±–æ—Ç –¥–ª—è –∑–∞–∫–∞–∑–∞ —Ç–∞–∫—Å–∏: –ø–∞—Å—Å–∞–∂–∏—Ä—ã —Å–æ–∑–¥–∞—é—Ç –∑–∞–∫–∞–∑—ã, –≤–æ–¥–∏—Ç–µ–ª–∏ –ø—Ä–∏–Ω–∏–º–∞—é—Ç –∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ü–∞—Å—Å–∞–∂–∏—Ä
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–∞–∫ –ø–∞—Å—Å–∞–∂–∏—Ä
- **–ó–∞–∫–∞–∑–∞—Ç—å —Ç–∞–∫—Å–∏** ‚Äî –∞–¥—Ä–µ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è ‚Üí –∞–¥—Ä–µ—Å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è ‚Üí –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–ø–æ –∂–µ–ª–∞–Ω–∏—é) ‚Üí –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
- **–ú–æ–∏ –∑–∞–∫–∞–∑—ã** ‚Äî —Å–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ –∏ —Å—Ç–∞—Ç—É—Å—ã
- **–û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑** ‚Äî –ø–æ–∫–∞ –∏—â–µ—Ç—Å—è –≤–æ–¥–∏—Ç–µ–ª—å
- `/cancel` ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π –¥–∏–∞–ª–æ–≥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞)
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: –≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–∏–Ω—è–ª, –≤ –ø—É—Ç–∏, –ø–æ–µ–∑–¥–∫–∞ –Ω–∞—á–∞–ª–∞—Å—å, –∑–∞–≤–µ—Ä—à–µ–Ω–∞

### –í–æ–¥–∏—Ç–µ–ª—å
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–∞–∫ –≤–æ–¥–∏—Ç–µ–ª—å
- **–í—ã–π—Ç–∏ –Ω–∞ –ª–∏–Ω–∏—é** / **–°–æ–π—Ç–∏ —Å –ª–∏–Ω–∏–∏**
- **–î–æ—Å—Ç—É–ø–Ω—ã–µ –∑–∞–∫–∞–∑—ã** ‚Äî —Å–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ –≤ –ø–æ–∏—Å–∫–µ –≤–æ–¥–∏—Ç–µ–ª—è
- **–í–∑—è—Ç—å –∑–∞–∫–∞–∑** ‚Äî –ø—Ä–∏–Ω—è—Ç—å –∑–∞–∫–∞–∑
- **–ú–æ–π –∑–∞–∫–∞–∑** ‚Äî —Ç–µ–∫—É—â–∏–π –∑–∞–∫–∞–∑ –∏ –∫–Ω–æ–ø–∫–∏: *–í –ø—É—Ç–∏ –∫ –ø–∞—Å—Å–∞–∂–∏—Ä—É* ‚Üí *–ü–∞—Å—Å–∞–∂–∏—Ä –≤ –º–∞—à–∏–Ω–µ* ‚Üí *–ó–∞–≤–µ—Ä—à–∏—Ç—å –ø–æ–µ–∑–¥–∫—É*
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–∞—Å—Å–∞–∂–∏—Ä—É –ø—Ä–∏ —Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–∞

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ (–ª–æ–∫–∞–ª—å–Ω–æ)

### –í–∞—Ä–∏–∞–Ω—Ç 1: —á–µ—Ä–µ–∑ run.sh (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
cd /home/nikolai/PycharmProjects/taxi_po_yuzhnomu
./run.sh
```

–°–∫—Ä–∏–ø—Ç —Å–∞–º —Å–æ–∑–¥–∞—Å—Ç `.venv`, –ø–æ—Å—Ç–∞–≤–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç –±–æ—Ç–∞.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –≤—Ä—É—á–Ω—É—é

```bash
cd /home/nikolai/PycharmProjects/taxi_po_yuzhnomu
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
python main.py
```

### –ó–∞–ø—É—Å–∫ –∏–∑ PyCharm

1. **File ‚Üí Settings ‚Üí Project ‚Üí Python Interpreter**
2. –î–æ–±–∞–≤—å—Ç–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä: **Add ‚Üí Existing** ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ  
   `.../taxi_po_yuzhnomu/.venv/bin/python`
3. –ï—Å–ª–∏ `.venv` –µ—â—ë –Ω–µ—Ç ‚Äî —Å–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:  
   `python3 -m venv .venv && .venv/bin/pip install -r requirements.txt`
4. –ó–∞–ø—É—Å–∫–∞–π—Ç–µ `main.py` –∫–∞–∫ –æ–±—ã—á–Ω–æ (Run).

### –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ `cannot import name 'Sentinel' from 'typing_extensions'`

–û–±–Ω–æ–≤—å—Ç–µ –ø–∞–∫–µ—Ç –≤ —Ç–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏, –æ—Ç–∫—É–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ:

```bash
python3.10 -m pip install --upgrade "typing_extensions>=4.6.0" --user
```

–õ–∏–±–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–í–∞—Ä–∏–∞–Ω—Ç 1** (run.sh) –∏–ª–∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä –∏–∑ `.venv` ‚Äî —Ç–∞–º —Å–≤–æ–∏, —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –ø–∞–∫–µ—Ç–æ–≤.

–ë–∞–∑–∞ SQLite: `taxi_bot.db` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞.

## –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä

–ö–æ–≥–¥–∞ –≤—Å—ë –ø—Ä–æ–≤–µ—Ä–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ:

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä.
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, —Å–æ–∑–¥–∞–π—Ç–µ `.env` —Å `BOT_TOKEN`.
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —á–µ—Ä–µ–∑ `systemd` –∏–ª–∏ `screen`/`tmux`, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```bash
python main.py
```

–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **webhook** –≤–º–µ—Å—Ç–æ long polling (–≤ `main.py` –∑–∞–º–µ–Ω–∏—Ç—å `start_polling` –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫—É webhook –∏ aiohttp/uvicorn). –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–≥—É –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç —Å webhook.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
taxi_po_yuzhnomu/
‚îú‚îÄ‚îÄ main.py           # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îú‚îÄ‚îÄ config.py     # –¢–æ–∫–µ–Ω, –ø—É—Ç–∏, –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ database.py   # SQLite: users, orders
‚îÇ   ‚îú‚îÄ‚îÄ keyboards.py  # –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ states.py     # FSM-—Å–æ—Å—Ç–æ—è–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ handlers/
‚îÇ       ‚îú‚îÄ‚îÄ start.py  # /start, –≤—ã–±–æ—Ä —Ä–æ–ª–∏
‚îÇ       ‚îú‚îÄ‚îÄ passenger.py
‚îÇ       ‚îî‚îÄ‚îÄ driver.py
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ .env.example
‚îî‚îÄ‚îÄ README.md
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–¢–æ–∫–µ–Ω** —Ö—Ä–∞–Ω–∏—Ç–µ –≤ `.env`, –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` –≤ git.
- –í `.gitignore` —É–∂–µ –µ—Å—Ç—å `.env` –∏ `*.db`.
